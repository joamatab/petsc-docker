sudo: 
  false

language: 
  c 

services:
  - docker

# addons:
#   apt:
#     packages:
#     - docker-engine

before_install:

env:
  global:
    - ACCOUNT=ocramz
    - PROJECT=petsc-docker
    - TAG=$ACCOUNT/$PROJECT
  # matrix:
  #   - BATCH_MODE="-batch"
  #   - BATCH_MODE=""

script:
  # # build Docker image
  # - docker build -t ${TAG} -f Dockerfile .
  - docker build -t $TAG-batch -f Dockerfile-batch .

  # run image, copy file from designated master node to compute node
  - docker run --rm -it --name "master" ${ACCOUNT}:${PROJECT}-batch
  - docker run --rm -it --name "compute" ${ACCOUNT}:${PROJECT}-batch
  